# Readme

文件I/O，其1：

读写XLSX。

## 目录

### xlsx.js

这个模块是一个入口点,它:

- 接收文件输入
- 协调整个解析过程
- 委托专门的解析器处理具体内容
- 最后组装成完整的工作簿模型

## 函数

### reconcile

`reconcile` 在这个项目中是一个非常重要的概念，字面意思是"协调"或"调和"。

#### 为什么需要 reconcile？

Excel 文件是一个复杂的文档，包含多个相互关联的部分：

- 工作簿(Workbook)
- 工作表(Worksheet)
- 图形(Drawings)
- 样式(Styles)
- 共享字符串(SharedStrings)

等等...
这些部分之间存在大量的引用关系，比如：

- 单元格引用共享字符串
- 图形引用媒体文件
- 工作表引用样式

等等...

#### reconcile 的作用

在读取 Excel 文件时，各个部分是分开解析的
reconcile 的作用就是将这些分散的部分"协调"在一起，建立正确的引用关系
可以理解为一个"后处理"步骤，确保所有组件都能正确地找到它们引用的其他组件

#### 为什么很多地方都有 reconcile？

因为每个层级都需要处理自己的引用关系,是一个自上而下的过程：

1. 先处理工作簿级别的关系
2. 然后处理图形、表格等组件的关系
3. 最后处理工作表级别的关系

#### 一个具体的例子

- 在 Excel 文件中，超链接是通过关系 ID (rId) 存储的
reconcile 过程会将这个 ID 转换为实际的 URL

#### 最后的清理

- 当所有关系都建立好后，一些中间数据就不再需要了
删除这些数据可以减少内存占用

#### 总结

可以把整个过程想象成拼图：
首先我们有很多散落的拼图块（各个组件的原始数据）
reconcile 就是将这些拼图块正确地拼接在一起的过程
每个层级的 reconcile 负责处理该层级的拼接工作
最后得到一个完整的图像（可用的 Excel 文档模型）
